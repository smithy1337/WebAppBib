<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <meta charset="UTF-8"></meta>
        <link rel="stylesheet" type="text/css" href="style.css"></link>
        <title> RainbowUnicornLibrary </title>
    </h:head>
    <h:body>
        <div class="header">
            <div class="header-thumb"><a href="index.xhtml"><img src="res/giflogo.gif" alt="logo" /></a></div>
            <div class="header-content">
                <h1>Rainbow Unicorn Library</h1>
            </div>
        </div>
        <h:form id="formInput">
        <div class="in">
                <!-- <input type="text" name="search" placeholder="Search.."></input> -->
                <p:remoteCommand name="search" actionListener="#{managedSearchBean.search()}"/>
                <p:inputText id="searchInput" value="#{managedSearchBean.searchTerm}" 
                             onkeypress="if (event.keyCode === 13) {search(); return false; }"/>
                <h:commandButton value="Search" action="#{managedSearchBean.search()}" />
        </div>
        </h:form>
        <br/>
        <main>
            <div class="tabs">
                    <input id="tab1" type="radio" name="tabs"/>
                    <label for="tab1">Books</label>

                    <input id="tab2" type="radio" name="tabs"/>
                    <label for="tab2">DVDs</label>

                    <input id="tab3" type="radio" name="tabs"/>
                    <label for="tab3">Magazines</label>

                    <section id="content1">
                        <table>
                            <tr>
                                <th>Title</th>
                                <th>ISBN</th>
                            </tr>
                            <tr>
                                <td>Harry Potter</td>
                                <td>123908190285</td>
                            </tr>
                            <tr>
                                <td>Die Zwerge</td>
                                <td>123890450932</td>
                            </tr>
                        </table>
                    </section>

                    <section id="content2">
                        <table>
                            <tr>
                                <th>Title</th>
                                <th>Author</th>
                            </tr>
                            <tr>
                                <td>Harry Potter</td>
                                <td>Joanne K. Rowling</td>
                            </tr>
                        </table>
                    </section>

                    <section id="content3">
                        <table>
                            <tr>
                                <th>Title</th>
                                <th>Edition</th>
                            </tr>
                            <tr>
                                <td>eMedia</td>
                                <td>21</td>
                            </tr>
                        </table>
                    </section>

                    <section id="content1">
                        <table>
                            <tr>
                                <th>Title</th>
                                <th>ISBN</th>
                            </tr>
                            <ui:repeat value="#{managedSearchBean.books}" var="book">
                                <tr>  
                                    <td><a href="detail.xhtml" onclick="#{managedSearchBean.bookAction(book)}">#{book.title}</a></td>
                                    <td>#{book.isbn}</td>
                                </tr>
                            </ui:repeat> 
                            
                            <p:dataTable id="bookTable" var="book" value="#{managedSearchBean.books}">
                                <p:column headerText="Title">
                                    <h:outputText value="#{book.title}" />
                                </p:column>
                                <p:column headerText="ISBN">
                                    <h:outputText value="#{book.isbn}" />
                                </p:column>
                                <!--<p:column style="width:32px;text-align: center">
                                    <p:commandButton icon="ui-icon-search" title="View" actionListener="#{managedSearchBean.listener}">
                                        <f:setPropertyActionListener value="#{book}" target="#{managedSearchBean.book}" />
                                    </p:commandButton>
                                </p:column> -->
                                <p:column style="width:32px;text-align: center">
                                    <h:form id="formViewButton">
                                        <p:column style="width:32px;text-align: center">
                                            <!-- <p:commandButton oncomplete="bookDialog.show()" icon="ui-icon-search" title="View" update=":formBookDetail:bookDetail">
                                                <f:setPropertyActionListener value="#{book}" target="#{managedSearchBean.book}" />
                                            </p:commandButton>-->
                                            <p:commandLink value="View Detail" type="button" title="View" immediate="true">
                                                <f:ajax listener="#{managedSearchBean.bookAction(book)}" render="bookDetail" onevent="function(data) { PF('bookDialog').show(); }" />
                     
                                            </p:commandLink>
                                        </p:column>
          
                                    <p:dialog id="bookDetail" header="Book Info" widgetVar="bookDialog" modal="true" showEffect="fade" hideEffect="fade" resizable="false">
                                        
                                            <p:outputPanel style="text-align:center;">     
                                                <p:panelGrid  columns="2" rendered="#{not empty managedSearchBean.book}" columnClasses="label,value">
                                                    <f:facet name="header">
                                                      <p:graphicImage value="#{managedSearchBean.book.pictureURL}" width="200" height="150"/> 
                                                    </f:facet>

                                                    <h:outputText value="Title:" />
                                                    <h:outputText value="#{managedSearchBean.book.title}" />

                                                    <h:outputText value="Publisher:" />
                                                    <h:outputText value="#{managedSearchBean.book.publisher}" />

                                                    <h:outputText value="Author:" />
                                                    <h:outputText value="#{managedSearchBean.book.author}"/>

                                                    <h:outputText value="ISBN:" />
                                                    <h:outputText value="#{managedSearchBean.book.isbn}" />
                                                </p:panelGrid>
                                                <p:dataTable id="bookTable" var="isbnBook" value="#{managedSearchBean.isbnBooks}">
                                                    <p:column headerText="Auflage:">
                                                        <h:outputText value="#{isbnBook.edition}" />
                                                    </p:column>
                                                    <p:column headerText="Regalnummer">
                                                        <h:outputText value="#{isbnBook.shelfPos}" />
                                                    </p:column>
                                                        <p:column headerText="Status">
                                                            <h:outputText value="#{isbnBook.status}" />
                                                    </p:column>
                                                </p:dataTable>
                                            </p:outputPanel>
                                      
                                    </p:dialog>
                                    
                                    </h:form> 
                                </p:column> 
                            </p:dataTable>
                            
                        </table>
                    </section>
            </div>
        </main>
        <br />
    </h:body>
</html>
